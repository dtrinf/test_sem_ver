name: Build and Deploy Service Feature Branch

run-name: "${{ inputs.SERVICE_NAME }}_${{ inputs.CLIENT }}_deploy"

###
# Workflow to Build and Deploy a Service Feature Branch
###

on:
  workflow_dispatch:
    inputs:
      #   RUNNER_LABEL:
      #     type: string
      #     required: false
      #     description: "Runner label to run the workflow on"
      #     default: "ubuntu-latest"
      ENV:
        type: string
        required: false
        default: "qa"
        description: "Environment to deploy to"
      CLIENT:
        type: string
        required: false
        default: "lifebit_internal"
        description: "Client to deploy to"

# Environment variables
env:
  VERSION: $GITHUB_REF
  APP: $GITHUB_REPOSITORY
  RUNNER_LABEL: "ubuntu-latest"
  ENV: ${{ inputs.ENV }}
  CLIENT: ${{ inputs.CLIENT }}

jobs:
  build-and-deploy:
    name: Build and Deploy
    runs-on: $RUNNER_LABEL
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: Print vars
        run: |
          echo "APP: $APP"
          echo "VERSION: $VERSION"
          echo "ENV: $ENV"
          echo "CLIENT: $CLIENT"
